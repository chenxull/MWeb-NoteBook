# 专注编排与部署：三剑客与Fleet

## 基本概念

- 编排：orchestration，它根部被部署对象之间的耦合关系，以及被部署对象环境的依赖，制定部署流程中各个动作的执行顺序，部署过程中所需要的依赖文件和被部署文件的存储位置和获取方式，以及如何验证部署成功。这些信息都会在编排工具中以制定的格式，来要求运维人员定义并保存起来，从而保证这个流程能够随时在全新的环境中可靠有序的重现出来。
- 部署:deployment ,按照编排所制定的内容和流程，在目标机器上执行编排所制定环境初始化，存放指定的依赖和文件，运行指定的部署动作，最终按照编排中的规则来确认部署成功

形象的来说，编排就是指挥家，他知道整个乐曲的全部流程，对于每个细节的掌握都了然于胸；部署就是整个乐队，他们严格的按照指挥家的意图用乐器来完成乐谱的执行。

## docker-compose
docker-compose在编排方面有着很作用，解决了运维过程中如何处理容器关系的问题，全部使用了docker标准API。但是docker-compose解决问题局限在编排上，部署基本没有涉及，很难服务于大众的云平台。

### docker-compose的局限性
 福田区高中学位补贴申报确认表 学校	深圳市福田区福景外国语	申报人	吴超雍 开户人	吴超雍	开户银行	中国建设银行 银行卡号	4367427200072426307	学生身份证号	441381200003074413 家长/监护人	吴德明	联系人手机号码	13537698585 申报时间	2017-04-13 15:18:50 签字	 年级	 日期	年月日 打印. docker-compose是面向单机部署的，在更多场合之下，管理员需要面对大量的物理服务器，这是docker-compose就显得力不从心了。即使通过docker-compose让容器顺利运行，这些容器的监控状态，故障恢复等管理动作都没办法直接和管理员产生交互。需要先通过docker Daemon，在通过docker-compose最后经过运维工具，才能实现和管理员之间的交互，这个过程是很复杂的。
2. 就算上述问题得到解决，对于网络和存储的问题还有许多的难点有待解决。这样一个接一个的问题在实际的生产过程中很不实际。

根据docker官方的推荐是compose同Machine和Swarm联动来解决这些问题。

## 跨平台宿主环境管理工具Machine
Machine这个工具把用户搭建docker环境的各种方案汇集在一起，解决人们的使用成本。

machine的主要功能是帮助用户在不同的云主机提供商上创建和管理虚拟机，并安装docker。Machine还提供了对虚拟机的管理，用户不需要打开一个个虚拟机软件就可以控制所有虚拟机状态，获得到docker客户端连接宿主机时所需要信息。

### Machine与IaaS平台
它的特点在于为很多IaaS平台开发一套驱动来进行轻量级操作。Machine处于辅助docker客户端的定位，他能提供对宿主机的管理都是轻量级操作。它将所有宿主机资源，不管来自本地还是来自云平台，都放在一个资源池中供用户使用，用户的操作目标只需要关注docker本身，尽可能减少在不同平台差异上消耗精力。

![](https://ws3.sinaimg.cn/large/006tNbRwly1fx5oz4uq6dj30ww0b6tan.jpg)

## 集群抽象工具Swarm
在提高对Docker宿主机管理效率和利用率上，集群化管理方式是一个正确的选择，swarm就是将多个宿主机抽象成一台的工具。

### Swarm简介

![](https://ws2.sinaimg.cn/large/006tNbRwgy1fx5p98t7vmj30zy0ggac4.jpg)
Swarm最大程度兼容docker远程api，其除了在多台docker宿主机上建立一层 抽象之外，还提供对宿主机资源的分配和管理，通过对宿主机添加标签信息来将宿主机资源进行细颗粒度分区，通过分区来帮助用户将容器部署到目标宿主机上，通过这种区分也提供了更多的资源调度策略。

## 编排之秀Fleet

