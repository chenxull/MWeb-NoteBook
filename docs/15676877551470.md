# 第四章 操作符

## 1 == 与对象的 equals 方法

### 1.1 == 操作符

二个操作元可以是基本类型，也可以是引用类型。

当此操作符二边都是引用类型变量时，这二个引用变量必须都引用同一个对象，结果才为 true

![](https://tva1.sinaimg.cn/large/006y8mN6ly1g6oyjs737fj310a0koqj1.jpg)

**1 操作符 == 与多态性**

对于引用类型变量，java 编译器根据变量被显示声明的类型去编译。 `==` 用于比较引用类型时， `==` 二边的变量被显示声明的类型必须是**同种类型**或有**继承关系，处于同一继承分支上，否则编译出错。** 在运行时，java 虚拟机将根据二边的**引用变量实际引用对象进行比较**。

**2 == 用于数组类型**

数组类型也是引用类型，可以用`==`

###1.2 对象的 equals 方法

equals 方法是在 object 类中定义的方法：

```java
public boolean equals(object obj){
    if(this == obj) return true;
    else return false;
}
```
规则：**当参数 obj 引用对象与当前对象为同一个对象时，就返回 true**.

jdk 中某些包覆盖了 object equals 方法，比较规则：**如果二个对象的类型一致，并且内容一致，则返回 true。**
![](https://tva1.sinaimg.cn/large/006y8mN6ly1g6oyy1jcv0j30zg0bi7d5.jpg)

**注意：**在实际中，比较字符串是否相等，通常按照内容来比较才会有意义，通常会使用 String 类的 equals 方法，而不是 `==`.

用户自定义类中也可以覆盖 equals 方法，重新定义比较规则。

![](https://tva1.sinaimg.cn/large/006y8mN6ly1g6oz2nl6c3j31420reqos.jpg)

## 2 instanceof 操作符
用于判断一个引用类型所引用的对象是否是另一个类的实例。

**1 instanceof 与多态**
instanceof左边操作元被显示声明的类型和右边操作元必须是同种类，或有继承关系，否则编译出错。

## 3 变量的赋值和类型转换

类型不一致时，从低位类型到高位类型自动转换，高位到低位需要强制类型转换。

![](https://tva1.sinaimg.cn/large/006y8mN6ly1g6ozkunow2j30wf0u01gu.jpg)

低位到高位的自动转换一般是安全的。高到底可能会出现精度丢失。

### 引用类型的类型转换

子类赋值给直接或间接父类，会自动进行类型转换。 父到子 需要强制类型转换。

对于引用类型变量，java 编译器只根据变量被显示声明的类型去编译。引用变量之间赋值时， `=` 二边的变量被显示声明的类型必须是**同种类型**或有**继承关系**，处于同一继承分支上，否则编译出错。