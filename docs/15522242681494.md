# Securing Docker Containers from Denial of Service (DoS) Attacks
## 摘要

在这边论文中，我们将要讨论关于容器安全的重要问题，并且我们提出了安全算法和方法去解决Docker容器技术中的DOS攻击相关问题。初步的试验和测试标明这些方法是起作用的。

## 介绍

### ARP Spoofing and MAC Flooding Attacks

当Docker创建新容器时，它还会建立一个具有唯一名称的新虚拟以太网接口，然后将此接口连接到网桥。 该接口还连接到容器的eth0接口，从而允许容器将数据包发送到网桥。 Docker的默认连接模型容易受到ARP欺骗和Mac泛洪攻击，因为网桥转发所有传入的数据包而不进行任何过滤。

### Docker Daemon Attack Surface

Docker允许宿主机和容器之间共享文件。这里的问题是可以启动一个容器，如果其中/ host目录将是Docker上的宿主机的/目录，那么容器将能够改变主机文件系统没有任何限制。 

### DoS attacks
VM中的应用仅仅被允许和虚拟机的内核通信，如果应用想逃离VM，它必须绕过VM内核和管理程序才能攻击主机内核。

容器可以直接和宿主机内核通信，这大大节省了攻击者进入主机系统的时间。当有一个或多个容器被攻破时，将会对宿主机产生巨大影响。

### Integrity of Docker Host Issue

第一个问题是关于Docker主机的完整性，如何确保Docker守护程序的可信度以及如何确保Docker主机以完整性启动。

第二个问题是关于Docker容器完整性的验证，image可以来自各种不信任的第三方源，如何确保正确的image被启动？ 此外，必须保证Docker引擎的安全性。 容器在主机内以及主机之间相互通信。 容器与其底层主机进行交互。 如果容器受到损害，如何遏制级联和灾难性影响是最重要的问题。 

## 现有的安全方法

Docker利用Linux内核命名空间来隔离用户，进程，网络和设备以及Cgroup以限制资源消耗。 用于确保Docker容器更严格安全性的广泛明确的机制包括进程，文件系统，设备，IPC和网络隔离。 另一个是访问限制。


### Sockets and API

### Security Hardening

 我们可以通过启用AppArmor，SELinux，Seccomp，GRSEC或其他强化解决方案来增加额外的安全层。 需要在不同层面形成和确定更新的安全方法和框架。 Rocket是最近创建的简单替代容器格式。像Rocket这样的简单系统通常更容易分析，因此可能更容易保护。 Apcera的混合云操作系统（HCOS）是增强容器安全性的另一种方式。 Twistlock是一种端到端的安全解决方案，解决了采用容器的头号障碍。开发人员可以获得可定制且友好的解决方案，他们可以在将容器推入生产之前进行安全质量检测。

### Mandatory Access Control (MAC)
针对Docker容器的最高安全性进行了改进。在处理容器时，核心自主访问控制（DAC）通常被认为是不够的，因为它给予主体灵活性以及它对安全策略的有限控制。 使用强制访问控制（MAC），主体无法绕过系统安全策略。 SELinux是MAC最广泛的实现之一。 在使用SELinux的系统中，Docker利用了sVirt项目范围内定义的策略，该项目旨在为不同的虚拟化系统定义SELinux策略。 在SELinux中，可以通过两种方式分离流程：

1.Type Enforcement (TE)

2.Multi-Category Security (MCS)

### Docker Security Policies
虽然提供了很多的安全策略，但是对于用户来说选择一个合适的安全策略还是很有挑战的。使用SELinux策略模块来构建和使用镜像是实现所需安全级别有前途的选择。这个模块会安装在主机系统中并且镜像中定义的一些进程都会有SELinux标签，这种模块被称为DockerPolicyModules（DPM），简而言之就是在dockerfile文件中将一个特定镜像所需要的SELinux标签给配置好。

image的DPM将在Dockerfile中指定，并在构建时嵌入到image元数据中。为了运行具有特定SELinux类型的容器化进程，image维护者可以使用特定类型标记image中的二进制文件并编写类型转换规则。这样，当执行二进制文件时，会为进程分配规则中定义的SELinux类型。即使在同一image中运行多个进程，仍然可以使用不同的SELinux标签执行它们。当Docker容器包含不同的image时，将安装组成容器的image的所有DPM。这使得父image中的进程也可以使用SELinux类型。因此，将DPM与Dockerfile（用于构建Docker镜像的更快机制）相结合，对Docker容器施加了访问限制。

### The Security Best Practices:

除了这些安全方法之外，以下是文献中提出的一些技术，用于确保Docker镜像，容器和主机的安全性。 有许多选项需要调整以进一步增加隔离并避免Docker施加的限制。 这些包括

- 优化镜像，减少容器中运行的二进制文件和服务，这样可以减少被攻击的可能。
- 使用只读文件系统，文件系统是攻击者攻击的重要途径
- 限制内核调用
- 开启并增强安全策略
- 限制网络访问，只允许相关并且受信的容器去和其他容器通信，可以使用-icc=false和配置防火墙参数来实现这些限制
- 限制存储空间和CPU的使用



## Docker平台DOS攻击的安全建议和实验
docker容器的防DOS攻击解决方案

![](https://ws1.sinaimg.cn/large/006tNbRwgy1fwqd671e2cj30oc0f840g.jpg)

测试情形如下：
### 1.在启动容器时限制容器的内存

### 2.在默认文件汇总分配内存预留

如果在启动容器时没有设置内存大小，docker daemon会检查默认配置文件，如果文件中设置了内存大小，则按照此内存来分配给容器。

### 3.内存限制未设置
当上述两种情况均为假时，我们必须提供默认值，以便任何DOS攻击都不会使系统崩溃。 对于此测试用例，我们通过除以总内存来限制内存资源，以便允许最小数量的容器。 以下列表显示了用于进行实验的威胁模型。








## 个人评价

这是一篇发表于2016 IEEE International Conference on Services Computing的文章， 基本上就是一篇总结性的文章，首先介绍了一下有容器有哪些安全危害，然后介绍了目前的一些安全问题解决方案，基本上都是介绍了一遍。最后提出了一个防止DOS攻击的安全配置模型，用3组不同的测试样例来验证自己的假设。最后总结成文。

个人感觉这样的文章没有太大的难度。




