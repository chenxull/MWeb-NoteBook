# 函数式编程

C++很大程度上解决了C语言中各种问题和不便，尤其是通过类，模板，虚函数和运行时识别等解决了C语言的泛型编程问题。但是如何才能做到 更为抽象的泛型呢？**函数式编程**

## 函数式编程

对于函数式编程来说，它只关心**定义输入数据和输出数据相关的关系，数学表达式里面其实是在一种映射，输入的数据和输出的数据关系是什么样的，是用函数来定义的**

函数式编程具有以下特点：

- stateless：函数不维护任何状态。函数式编程的核心精神是stateless，简而言之就是它不能存在状态，打个比方，你给我数据我处理完扔出来，里面的数据是不变的
- immutable：输入数据是不能动的，动了输入数据就有危险，所以要返回新的数据集

优势：
- 没有状态就没有伤害
- 并行执行无伤害
- copy-paste重构代码无伤害
- 函数的执行没有顺序上的问题

**函数式编程的好处**
- 惰性求值。表达式不在它被绑定到变量之后就立即求值，而是在该值被取用的时候求值。
- 确定性：就像在数学公式中那样f(x)=y这个函数无论在什么场景下，都会得到同样的结果，所谓的场景不同，就是我们的函数会根据运行中的状态信息的不同而发生变化。

因为没有状态，并行的数据无需上锁。


### 函数式编程用到的技术

- **first class function（头等函数）** ：这个技术可以让你的的幻术就像变量一样来使用。
- **tail recursion optimization(尾递归优化**：正常递归的话，如果递归的很深stack受不了， 并会导致性能大幅度下降。因此，使用尾递归优化技术--每次递归都会重用stack，这样就可以提升性能
- **map & reduce**：函数式编程中最常用的就是对一个集合做Map和Reduce操作。
- **pipeline(管道）**：将函数实例成一个一个action，然后将一组action放到一个数组或者列表中，再把数据传个这个action list，这个数据就像一个pipeline一样顺序的被各个函数所操作。
- **recursing(递归）**：简化代码，把复杂的问题简单化
- **currying（柯里化）**：将一个函数的多个参数分解成多个函数，然后将函数多层封装起来，每层函数都返回一个函数去接受下一个参数，这可以简化函数的多个参数。
- **higher order function(高阶函数）**:所谓高阶函数就是函数当参数，把传入的函数做一个封装，然后返回这个封装函数。现象上就是函数传进传出，就像面向对象对象满天飞一样。这个技术用来做 Decorator 很不错。

```python
def inc(x):
    def incx(y):
        return x+y
    return incx
 
inc2 = inc(2)
inc5 = inc(5)
 
print inc2(5) # 输出 7
print inc5(5) # 输出 10
```

**函数式编程的理念**
- 把函数当成变量来用，关注描述问题而不是怎么实现，这样可让代码更易读
- 应为函数返回里面的这个函数，所有函数关注的是表达式，关注的是描述这个问题，而不是怎么实现这个事情。

我们把以前的过程式编程范式叫做指令式编程，而把函数式编程范式叫做声明式编程。

### 函数式语言的三套件

**Map，Reduce和Filter**，代码变成了在描述你要干什么，而不是怎么干。

### 函数式编程的核心思想

将运算过程尽量写成一系列嵌套的函数调用，关注的是做什么而不是怎么做，因而也被称为声明式编程。一无状态和不可变为主要特点，代码简洁易于理解，便于进行并行执行，易于做代码重构，函数执行没有顺序上的问题，支持惰性求值，具有函数的确定性--无论什么场景下都会得到同样的结果。